# 프로세스와 스레드

## 프로그램

파일이 저장 장치에 저장되어 있으나 **메모리에 올라가지 않은** **정적인** 상태이다.

- 메모리에 할당되지 않은

      운영체제가 프로그램에게 독립적인 메모리 공간을 할당하지 않았다는 의미이다. 프로그램은 운영체제로부터 메모리 공간을 할당받아야 실행할 수 있다.

- 정적인

      아직 실행되지 않은 상태

프로그램을 실행하면 파일을 메모리에 올려 동적인 상태로 만든다. 이 상태의 프로그램을 프로세스라 한다.

## 프로세스

실행 중인 프로그램을 의미한다. 스케줄링 단계에서의 작업을 의미하기도 한다.

- 운영체제로부터 자원을 할당받은 작업의 단위이다.

프로그램이 복잡해져 여러 동작을 하자 프로세스 하나만을 사용해 프로그램을 실행하는 데 어려움이 있었다.

- 각 프로세스는 자신에게 할당된 메모리 내의 정보에만 접근할 수 있으므로 여러 개의 프로세스를 하나의 프로그램에 사용할 수 없었다.

- 따라서 프로세스보다 더 작은 실행 단위가 필요했고, 이것이 스레드이다.

## 스레드

스레드는 프로세스와 달리 스레드 간 메모리를 공유한다. 즉 프로세스의 자원을 공유한다.

- 프로세스가 할당 받은 자원을 이용하는 실행 흐름의 단위이다.

## 프로세스와 스레드

프로세스는 운영체제로부터 독립적인 시스템 자원을 할당받지만,

스레드는 프로세스가 할당 받은 메모리 영역을 동일 프로세스 내 다른 스레드와 공유한다.

- 각 스레드는 자신 별도의 Stack을 가지고, Heap, Data, Code 영역은 공유한다.

## 싱글 스레드

하나의 프로세스에서 하나의 스레드를 실행하며 하나의 레지스터와 스택으로 표현한다.

- 장점

  - 자원 접근에 대한 동기화, 스케줄링을 신경쓰지 않아도 된다.

    - 여러 개의 스레드를 사용하는 멀티 스레드의 경우 각 스레드가 정상적으로 동작하려면 공용 자원(Heap, Data, Code 메모리 영역)에 대한 접근을 통제하여야 한다. 이것은 많은 노력과 비용을 필요로 한다.

  - 스레드가 하나이기 때문에 작업전환 작업을 요구하지 않는다.

    - 작업전환은 여러 개의 스레드가 하나의 프로세스를 공유할 때 발생하는 작업으로 많은 비용을 필요로 한다.

  - 단순히 CPU만을 사용하는 계산이라면 멀티 스레드보다 효율적이다.

    - 2개의 작업을 하나의 스레드로 처리하는 경우와 2개의 스레드로 처리하는 경우를 가정한다.

    - 2개의 스레드로 처리하는 경우 짧은 시간 동안 2개의 스레드가 번갈아 작업을 수행해 동시에 두 작업이 처리되는 것처럼 보인다.

    - 하지만 두 스레드 간의 작업전환 시간 때문에 싱글 스레드보다 더 오래 걸릴 수 있다.

- 단점

  - 여러 개의 CPU를 활용하지 못한다.

    - 여러 개의 CPU를 활용하려면 cluster 모듈을 사용하거나, 여러 개의 프로그램 인스턴스를 사용한다.

## 멀티 스레드

하나의 프로세스 내에서 여러 개의 스레드를 사용한다.

프로세스 내에서 자원을 공유하기 때문에 자원 생성과 관리의 중복이 최소화된다.

서버가 많은 요청을 효율적으로 수행할 수 있는 환경을 제공한다.

각각의 스레드는 고유의 레지스터와 스택으로 표현한다.

- 장점

  - 새로운 프로세스를 생성하는 것보다 새로운 스레드를 생성하는 것이 빠르다.

  - 프로세스의 자원(Heap, Data, Code)과 상태를 공유하여 효율적으로 운영할 수 있다.

  - 프로세스 간 작업전환보다 스레드 간 작업전환이 더 빠르다.

- 단점

  - 메모리를 공유하기 때문에 자원에 접근하는 스레드 스케줄링을 신경써야 한다.

  - 운영체제의 지원이 필요하다.

    - MS-DOS와 같은 오래된 운영체제가 아닌 이상 대부분의 운영체제는 멀티 스레딩을 지원한다.
